pipeline{ 
	agent any 
	stages {
		stage('testing'){
			steps{
				sh "echo webhook"				
				sh "echo testing webhook"
			}
		}

		stage('notification'){
			steps{
				withCredentials([string(credentialsId: 'Discord_webhook_ks', variable: 'discord_webhook_url')]) {
					def git_message = git log --format="medium" -1 ${GIT_COMMIT}

					discordSend description: "Flask_project (ノಠ益ಠ)ノ彡┻━┻ \n\n git commit: ${git_message}\n job: $JOB_NAME \n status: ${currentBuild.currentResult} \n BuildID: $BUILD_ID", 
    				footer: "End of transmission",
						link: env.BUILD_URL,
						result: currentBuild.currentResult,
						thumbnail: 'https://cdn.discordapp.com/attachments/859942982425378817/862792459900944415/jenkins-icon-Matthew-Cradit.png',
						title: JOB_NAME,
						webhookURL: "$discord_webhook_url"
				}
			}
		}
	}
}
